<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page A-frame</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/kylebakerio/ada-water/ada-water.js"></script>
    <script
        src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
</head>

<body>
    <img id="sky" src="./assets/sky.png" alt="">


    <!-- Enregistrement arbre -->
    <a-asset-item id="arbre-gros" src="./assets/trees/big-tree.glb"></a-asset-item>
    <a-asset-item id="arbre-tombe" src="./assets/trees/arbre-tombe.glb"></a-asset-item>
    <a-asset-item id="arbre-beau" src="./assets/trees/tree-vert-beau.glb"></a-asset-item>
    <a-asset-item id="arbre-penche" src="./assets/trees/tree-vert-penche-arr.glb"></a-asset-item>
    <a-asset-item id="arbre-penche2" src="./assets/trees/tree-vert-penche-arr2.glb"></a-asset-item>
    <a-asset-item id="arbre-souche" src="./assets/trees/tree-souche.glb"></a-asset-item>
    <a-asset-item id="arbre-souche2" src="./assets/trees/souche-arbre.glb"></a-asset-item>

    <!-- Enregistrement Vegétations -->
    <a-asset-item id="fleur-vert" src="./assets/flowers-green.glb"></a-asset-item>
    <a-asset-item id="fleur-violette" src="./assets/flowers-purple.glb"></a-asset-item>
    <a-asset-item id="fleur-rose" src="./assets/tulip-rose.glb"></a-asset-item>
    <a-asset-item id="nenuphare-fleur" src="./assets/nenuphare-fleuri.glb"></a-asset-item>
    <a-asset-item id="nenuphare-pas-fleur" src="./assets/nenuphare.glb"></a-asset-item>
    <a-asset-item id="caillou1" src="./assets/stone1.glb"></a-asset-item>
    <a-asset-item id="caillou2" src="./assets/stone2.glb"></a-asset-item>
    <a-asset-item id="caillou3" src="./assets/stone3.glb"></a-asset-item>
    <a-asset-item id="ile" src="./assets/ground.glb"></a-asset-item>
    <a-asset-item id="herbe" src="./assets/grass.glb"></a-asset-item>
    <a-asset-item id="fleur-blanche" src="./assets/flowers-blanche.glb"></a-asset-item>
    <a-asset-item id="ile-fleuri" src="./assets/ilefleuri.glb"></a-asset-item>
    <a-asset-item id="pierre-ghibli" src="./assets/ghibli-rock.glb"></a-asset-item>
    <a-asset-item id="ghibli-statue" src="./assets/ghibli-statue.glb"></a-asset-item>
    <a-asset-item id="arbre-ghi" src="./assets/kodama_diorama.glb"></a-asset-item>

    <!-- Enregistrement Faune -->
    <a-asset-item id="spider" src="./assets/spider.glb"></a-asset-item>
    <a-asset-item id="papillon-orange" src="./assets/orange-butterfly.glb"></a-asset-item>
    <a-asset-item id="papillon-bleu" src="./assets/blue-butterfly.glb"></a-asset-item>
    <a-asset-item id="gambas-debout" src="./assets/gambas-debout.glb"></a-asset-item>
    <a-asset-item id="gambas-debout2" src="./assets/gambas_debout2.glb"></a-asset-item>
    <a-asset-item id="gambas-boring" src="./assets/gambas-boring.glb"></a-asset-item>

    <!-- Enregistrement Item -->
    <a-asset-item id="mask" src="./assets/mask.glb"></a-asset-item>
    <a-asset-item id="epee" src="./assets/mononoke-sword.glb"></a-asset-item>


    <!--fog="type: linear; color: #001d3d; near: 35; far: 60"  -->
    <a-scene fog="type: linear; color: #001d3d; near: 35; far: 60">
        <a-sky color="#adb5bd"></a-sky>
        <!-- <a-entity scale="3 3 3" environment="preset: forest"></a-entity> -->

        <a-plane scale="200 200 200" rotation="270 0 0" position="0 0 0" color="#3a86ff"></a-plane>

        <!-- Lake -->
        <a-water scale="30 30 1" position="0 .55 0" width="10" height="80" voronoi-points="5" opacity=".7"></a-water>
        <!-- <a-sphere width="50" scale="10 10 0.5" rotation="-90 0 0" density="40" position="0 0 0"
            material="shader: standard; color: #FFFFFF; src: url(./assets/eau.png)"
            animation__texture="property: material.offset; to: 1 1; dur: 50000; loop: true; easing: linear;"></a-sphere> -->


        <!-- Zone Arbre intérieur -->

        <a-entity gltf-model="#arbre-gros" rotation="0 -110 0" position="-5 19.6 25" scale="15 15 15"></a-entity>
        <a-entity gltf-model="#arbre-gros" rotation="0 110 0" position="-22 19.6 -19" scale="15 15 15"></a-entity>
        <a-entity gltf-model="#arbre-tombe" rotation="0 160 0" position="-16.944 1.121 0.654" scale="4 4 4"></a-entity>
        <a-entity gltf-model="#arbre-beau" rotation="0 -71 0" position="-24.520 0.95 10" scale="4 4 4"></a-entity>
        <a-entity gltf-model="#arbre-beau" rotation="0 -71 0" position="16.338 0.95 -18.839" scale="4 4 4"></a-entity>
        <a-entity gltf-model="#arbre-penche" rotation="0 0 0" position="-5.607 0.95 -31.487" scale="4 4 4"></a-entity>
        <a-entity gltf-model="#arbre-penche2" rotation="0 0 0" position="15.813 1 11" scale="4 4 4"></a-entity>
        <a-entity gltf-model="#arbre-souche" rotation="0 200 0" position="18.047 1.840 -12.1" scale="4 4 4"></a-entity>
        <a-entity gltf-model="#arbre-penche2" rotation="0 0 0" position="-41 1 -3.056" scale="9 9 9"></a-entity>


        <!-- Zone extérieur -->
        <a-entity gltf-model="#arbre-penche" rotation="0 0 0" position="31.106 0.7 7.513" scale="6 6 6"></a-entity>
        <a-entity gltf-model="#arbre-penche2" rotation="0 90 0" position="18.502 1 41.162" scale="20 20 20"></a-entity>
        <a-entity gltf-model="#arbre-beau" rotation="0 -71 0" position="15.306 0.95 -46.121"
            scale="15 15 15"></a-entity>
        <a-entity gltf-model="#arbre-gros" rotation="0 -3.870 0" position="54.362 51.960 -14.467"
            scale="40 40 40"></a-entity>
        <a-entity gltf-model="#caillou1" material="color:#000;" rotation="0 112 0" position="-19.6 0 -38.4"
            scale="50 50 50"></a-entity>
        <a-entity gltf-model="#caillou2" material="color:#000;" rotation="0 80 0" position="-30.209 -.5 21.784"
            scale="15 15 15"></a-entity>
        <a-entity gltf-model="#arbre-beau" rotation="0 20 0" position="-35.609 0 48.054" scale="25 25 25"></a-entity>
        <a-entity gltf-model="#arbre-penche" rotation="0 0 0" position="-44.845 1.2 -53.288"
            scale="25 25 25"></a-entity>
        <a-entity gltf-model="#caillou3" material="color:#000;" rotation="0 83 0" position="23.574 3.5 -31.416"
            scale="6 6 6"></a-entity>

        <!-- Faune -->
        <!-- <a-entity gltf-model="#spider" rotation="0 180 0" position="-3 1 2" scale="0.3 0.3 0.3"></a-entity>
        <a-entity gltf-model="#papillon-orange" rotation="0 180 0" position="-0 2 2" scale="0.5 0.5 0.5"></a-entity>
        <a-entity gltf-model="#papillon-bleu" rotation="0 90 0" position="-9 2 2" scale=".5 .5 .5"></a-entity> -->

        <!-- Végétations -->
        <a-entity gltf-model="#ile" rotation="0 0 0" position="0 .8 0" scale=".2 .2 .2"></a-entity>
        <a-entity gltf-model="#ile" rotation="0 80 0" position="0.6 .7 -12.553" scale=".13 .13 .13"></a-entity>
        <a-entity gltf-model="#fleur-vert" rotation="0 0 0" position="0 1 -2" scale="2 2 2"></a-entity>
        <a-entity gltf-model="#fleur-blanche" rotation="0 0 0" position="-1.597 0.917 0.829"
            scale="1.5 1.5 1.5"></a-entity>
        <a-entity gltf-model="#ile-fleuri" rotation="0 0 0" position="-9.071 .7 -4.169"
            scale=".015 .015 .015"></a-entity>
        <a-entity gltf-model="#ile-fleuri" rotation="0 80.000 0" position="5.743 .7 6.010"
            scale="0.017 0.017 0.017"></a-entity>
        <a-entity gltf-model="#fleur-violette" rotation="0 0 0" position="-0.380 0.805 -13.855"
            scale="1.2 1.2 1.2"></a-entity>
        <a-entity gltf-model="#fleur-rose" rotation="0 0 0" position="0.970 1.8 1.699" scale="1.3 1.3 1.3"></a-entity>
        <a-entity gltf-model="#nenuphare-fleur" rotation="0 0 0" position="-2.026 0.40 -6.77"
            scale="0.4 0.4 0.4"></a-entity>
        <a-entity gltf-model="#nenuphare-fleur" rotation="0 0 0" position="0.122 0.40 7.781"
            scale="0.4 0.4 0.4"></a-entity>
        <a-entity gltf-model="#nenuphare-fleur" rotation="0 0 0" position="8.060 0.40 3.696"
            scale="0.5 0.5 0.5"></a-entity>
        <a-entity gltf-model="#nenuphare-pas-fleur" rotation="0 0 0" position="-6.760 0.610 1.468"
            scale="0.1 0.1 0.1"></a-entity>
        <a-entity gltf-model="#nenuphare-pas-fleur" rotation="0 0 0" position="3 0.650 10.803"
            scale="0.1 0.1 0.1"></a-entity>
        <a-entity gltf-model="#nenuphare-pas-fleur" rotation="0 0 0" position="4.660 0.610 -6.812"
            scale="0.12 0.12 0.12"></a-entity>
        <a-entity gltf-model="#ghibli-statue" rotation="0 -140.000 0" position="36.633 2.2 34.253"
            scale=".3 .3 .3"></a-entity>
        <a-entity gltf-model="#arbre-ghi" rotation="0 -70 0" position="9.568 2.820 15.360"
            scale="1 1 1"></a-entity>
        <a-entity gltf-model="#herbe" rotation="0 0.8 0" position="0.613 0.945 -0.728" scale="5 5 5"></a-entity>
        <a-entity gltf-model="#herbe" rotation="0 10 0" position="0.621 0.945 -12.508" scale="5.000 3 4"></a-entity>

        <!-- Item -->
        <a-entity interactablemask gltf-model="#mask" rotation="15.000 -120.000 0" position="-25.935 15.432 -20.464"
            scale="1 1 1"></a-entity>
        <a-entity interactablesword gltf-model="#epee" rotation="0 140.000 -120.000" position="20.459 1.942 -10.313"
            scale=".001 .001 .001"></a-entity>
        <a-entity interactable gltf-model="#gambas-debout" rotation="0 200.000 0" position="17.978 0.570 10.960"
            scale="0.6 0.6 0.6"></a-entity>
        <a-entity interactable gltf-model="#gambas-debout2" rotation="0 180 10.010" position="16.752 46.005 37.438"
            scale="0.6 0.6 0.6"></a-entity>
        <a-entity interactable class="clickable" gltf-model="#gambas-boring" rotation="-5.000 141.520 5"
            position="-18.204 1.264 0.533" scale="0.500 0.500 0.500"
            material="emissive: #caf0f8; emissiveIntensity:40;"></a-entity>
        <a-entity interactable class="clickable" gltf-model="#gambas-boring" rotation="0 0 20.000"
            position="-19.741 19.498 -16.625" scale="0.500 0.500 0.500"></a-entity>
        <a-entity interactable class="clickable" gltf-model="#gambas-boring" rotation="-15.000 80 0.000"
            position="19.689 0.630 -11.790" scale="0.45 0.45 0.45"
            material="emissive: #caf0f8; emissiveIntensity:40;"></a-entity>



        <!-- Lights -->
        <a-entity light="type: ambient; color: #caf0f8; intensity: 1; " position="0 40 1.431"
            rotation="-90.000 0 0"></a-entity>
        <a-entity light="type: directional; color: #caf0f8; intensity: 1;" position="0 40 1.431" rotation="-90.000 0 0"></a-entity>

        <a-sphere rotation="-8.360 0 -50.000" position="33.330 28.387 -4.080"
            material="emissive: #caf0f8; emissiveIntensity:40;" scale=".5 100 .5" opacity="0.1"></a-sphere>
        <a-sphere rotation="0 0 60.000" position="-49.950 30 0" material="emissive: #caf0f8; emissiveIntensity:40;"
            scale=".5 100 .5" opacity="0.1"></a-sphere>
        <a-sphere rotation="20.000 0 10.000" position="0.140 0 -0.320"
            material="emissive: #caf0f8; emissiveIntensity:40;" scale=".5 100 .5" opacity="0.15"></a-sphere>
        <a-sphere rotation="-19.070 0 15.000" position="-7.930 30 -10.290"
            material="emissive: #caf0f8; emissiveIntensity:40;" scale=".5 100 .5" opacity="0.15"></a-sphere>
        <!-- <a-entity light="type: spot; color: #90e0ef; intensity: 3; angle:2.000;" position="-18.960  40 0" rotation="-90.000 0 0"></a-entity> -->



        <!-- CAMERA & manettes -->
        <a-entity movement-controls="speed:0.5;" id="rig" position="0 1.8 0" rotation="0 180 0">
            <a-camera look-controls="pointerLockEnabled: true" position="0 1.6 0" rotation="0 0 0">
                <!--  <a-text id="score" value="Score: 0" position="2.7 1.5 -2" color="#FFF" scale=".7 .7 .7"></a-text> -->
               
                <!-- <a-box scale="1 .1 1" color="#000" opacity=".5" position="0 2 0" rotation="0 0 0"></a-box> -->
                    <a-text id="gambas" value="Trouve les Kodamas : 0/5" align="center" position="-0. -0.72 -2.2" color="#FFF" scale=".4 .4 .4" geometry="primitive:plane; width:4; height:.5" material="color:#000; opacity:.7;"></a-text>
                    <a-text id="sword" value="Trouve l'epee de la princesse : 0/1" position="-0. -0.6 -2.2" color="#FFF" scale=".4 .4 .4" align="center" geometry="primitive:plane; width:4; height:.5" material="color:#000; opacity:.7;"></a-text>
                    <a-text id="masque" value="Trouve le masque de la princesse : 0/1" position="-0. -0.48 -2.2" color="#FFF" scale=".4 .4 .4"  align="center" geometry="primitive:plane; width:4; height:.5" material="color:#000; opacity:.7;"></a-text>
                <a-cursor color="#FFF"></a-cursor>
            </a-camera>
            <a-entity laser-controls="hand: left"
                raycaster="objects: .clickable; far: 20; showLine: true; raycaster: red;"
                position="-0.5 1.5 -0.5"></a-entity>
            <a-entity laser-controls="hand: right"
                raycaster="objects: .clickable; far: 20; showLine: true; raycaster: red;"
                position="0.5 1.5 -0.5"></a-entity>
        </a-entity>

        <!-- Sound -->
        <a-sound src="./sound/ghiblisound.mp3" volume="3" loop="true" autoplay="true"></a-sound>
    </a-scene>
</body>

</html>
<script>
    // Initialisation du compteur
    let gambas = 0;
    let sword = 0;
    let mask = 0;
    

    // Fonction pour mettre à jour le texte du score
    function updateScore() {
        const scoreText = document.querySelector("#gambas");
        const scoreSword = document.querySelector("#sword");
        const scoreMask = document.querySelector("#masque");
        if (scoreText) {
            scoreText.setAttribute("value", "Trouve les Kodamas : " + gambas +"/5");
            console.log("Score mis à jour : " + gambas); // Affiche le score dans la console
        }
        if (scoreSword) {
            scoreSword.setAttribute("value", "Trouve l'epee de la princesse : " + sword +"/1");
            console.log("Score mis à jour : " + sword); // Affiche le score dans la console
        }
        if (scoreMask) {
            scoreMask.setAttribute("value", "Trouve le masque de la princesse : " + mask +"/1");
            console.log("Score mis à jour : " + mask); // Affiche le score dans la console
        }
    }


    // Component to enable rotation on interaction
    AFRAME.registerComponent("interactable", {
        init: function () {
            this.el.addEventListener("click", () => {
                // Vérifiez si l'objet est déjà invisible (cliqué précédemment)
                if (this.el.getAttribute("visible") === true) {
                    // Incrémenter le score si l'objet est encore visible
                    gambas += 1;
                    // Mettre à jour l'affichage du score
                    updateScore();
                    // Faire disparaître l'objet après le clic
                    this.el.setAttribute("visible", "false");
                }
                });
            
        },
        
    });

    AFRAME.registerComponent("interactablesword", {
        init: function () {
            this.el.addEventListener("click", () => {
                // Vérifiez si l'objet est déjà invisible (cliqué précédemment)
                if (this.el.getAttribute("visible") === true) {
                    // Incrémenter le score si l'objet est encore visible
                    sword += 1;
                    // Mettre à jour l'affichage du score
                    updateScore();
                    // Faire disparaître l'objet après le clic
                    this.el.setAttribute("visible", "false");
                }
                });
            
        },
        
    });

    AFRAME.registerComponent("interactablemask", {
        init: function () {
            this.el.addEventListener("click", () => {
                // Vérifiez si l'objet est déjà invisible (cliqué précédemment)
                if (this.el.getAttribute("visible") === true) {
                    // Incrémenter le score si l'objet est encore visible
                    mask += 1;
                    // Mettre à jour l'affichage du score
                    updateScore();
                    // Faire disparaître l'objet après le clic
                    this.el.setAttribute("visible", "false");
                }
                });
            
        },
        
    });
</script>